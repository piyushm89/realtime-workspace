{"ast":null,"code":"var _jsxFileName = \"/home/piyush/Desktop/collabdraw/realtime-workspace/client/src/components/ExcalidrawCanvas.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState, useCallback } from 'react';\nimport LibraryPanel from './LibraryPanel';\nimport ExportImportPanel from './ExportImportPanel';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ExcalidrawCanvas = ({\n  socket,\n  workspaceData\n}) => {\n  _s();\n  const canvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [tool, setTool] = useState('selection');\n  const [color, setColor] = useState('#000000');\n  const [strokeWidth, setStrokeWidth] = useState(2);\n  const [fillStyle, setFillStyle] = useState('transparent');\n  const [opacity, setOpacity] = useState(100);\n  const [fontSize, setFontSize] = useState(20);\n  const [fontFamily, setFontFamily] = useState('Arial');\n  const [zoom, setZoom] = useState(100);\n  const [startPoint, setStartPoint] = useState(null);\n  const [currentShape, setCurrentShape] = useState('rectangle');\n  const [isTyping, setIsTyping] = useState(false);\n  const [textInput, setTextInput] = useState('');\n  const [textPosition, setTextPosition] = useState(null);\n  const [roughness, setRoughness] = useState(1);\n  const [strokeStyle, setStrokeStyle] = useState('solid');\n  const [arrowType, setArrowType] = useState('none');\n  const [elements, setElements] = useState([]);\n  const [showLibrary, setShowLibrary] = useState(false);\n  const [showExportImport, setShowExportImport] = useState(false);\n  const [canvasOffset, setCanvasOffset] = useState({\n    x: 0,\n    y: 0\n  });\n  const [isDragging, setIsDragging] = useState(false);\n\n  // Tools available\n  const tools = [{\n    name: 'selection',\n    icon: '↖️',\n    label: 'Select'\n  }, {\n    name: 'hand',\n    icon: '✋',\n    label: 'Hand'\n  }, {\n    name: 'rectangle',\n    icon: '⬜',\n    label: 'Rectangle'\n  }, {\n    name: 'diamond',\n    icon: '💎',\n    label: 'Diamond'\n  }, {\n    name: 'ellipse',\n    icon: '⭕',\n    label: 'Ellipse'\n  }, {\n    name: 'arrow',\n    icon: '➡️',\n    label: 'Arrow'\n  }, {\n    name: 'line',\n    icon: '📏',\n    label: 'Line'\n  }, {\n    name: 'draw',\n    icon: '✏️',\n    label: 'Draw'\n  }, {\n    name: 'text',\n    icon: '📝',\n    label: 'Text'\n  }, {\n    name: 'image',\n    icon: '🖼️',\n    label: 'Image'\n  }, {\n    name: 'eraser',\n    icon: '🧽',\n    label: 'Eraser'\n  }];\n\n  // Action buttons\n  const actionButtons = [{\n    name: 'library',\n    icon: '📚',\n    label: 'Library',\n    onClick: () => setShowLibrary(true)\n  }, {\n    name: 'export',\n    icon: '📤',\n    label: 'Export',\n    onClick: () => setShowExportImport(true)\n  }, {\n    name: 'undo',\n    icon: '↶',\n    label: 'Undo',\n    onClick: handleUndo\n  }, {\n    name: 'redo',\n    icon: '↷',\n    label: 'Redo',\n    onClick: handleRedo\n  }];\n\n  // Colors\n  const colors = ['#000000', '#e03131', '#2f9e44', '#1971c2', '#f08c00', '#e64980', '#7950f2', '#495057', '#ffffff', '#fab005'];\n\n  // Stroke widths\n  const strokeWidths = [1, 2, 4, 8];\n\n  // Fill styles\n  const fillStyles = ['transparent', 'solid', 'hachure', 'cross-hatch'];\n\n  // Font families\n  const fontFamilies = ['Arial', 'Helvetica', 'Georgia', 'Times', 'Courier'];\n\n  // Initialize canvas\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    canvas.width = 1200;\n    canvas.height = 800;\n    const ctx = canvas.getContext('2d');\n    ctx.lineCap = 'round';\n    ctx.lineJoin = 'round';\n\n    // White background\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    console.log('Enhanced Canvas initialized');\n  }, []);\n\n  // Get canvas coordinates\n  const getCanvasPoint = useCallback(e => {\n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n    return {\n      x: (e.clientX - rect.left) * scaleX,\n      y: (e.clientY - rect.top) * scaleY\n    };\n  }, []);\n\n  // Generate unique ID for elements\n  const generateId = () => Math.random().toString(36).substring(2, 15);\n\n  // Undo/Redo functionality\n  const [history, setHistory] = useState([]);\n  const [historyIndex, setHistoryIndex] = useState(-1);\n  const saveToHistory = newElements => {\n    const newHistory = history.slice(0, historyIndex + 1);\n    newHistory.push([...newElements]);\n    setHistory(newHistory);\n    setHistoryIndex(newHistory.length - 1);\n  };\n  const handleUndo = () => {\n    if (historyIndex > 0) {\n      setHistoryIndex(historyIndex - 1);\n      setElements(history[historyIndex - 1]);\n      redrawCanvas(history[historyIndex - 1]);\n    }\n  };\n  const handleRedo = () => {\n    if (historyIndex < history.length - 1) {\n      setHistoryIndex(historyIndex + 1);\n      setElements(history[historyIndex + 1]);\n      redrawCanvas(history[historyIndex + 1]);\n    }\n  };\n\n  // Redraw canvas with elements\n  const redrawCanvas = elementsToRender => {\n    const ctx = canvasRef.current.getContext('2d');\n    ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n    elementsToRender.forEach(element => {\n      renderElement(ctx, element);\n    });\n  };\n\n  // Render individual element\n  const renderElement = (ctx, element) => {\n    ctx.globalAlpha = (element.opacity || 100) / 100;\n    switch (element.type) {\n      case 'rectangle':\n        drawRoughRectangle(ctx, element.startX, element.startY, element.endX - element.startX, element.endY - element.startY, {\n          strokeColor: element.color,\n          fillColor: element.fillStyle === 'transparent' ? 'transparent' : element.color,\n          strokeWidth: element.strokeWidth,\n          roughness: element.roughness || 1\n        });\n        break;\n      case 'ellipse':\n        const centerX = (element.startX + element.endX) / 2;\n        const centerY = (element.startY + element.endY) / 2;\n        const radiusX = Math.abs(element.endX - element.startX) / 2;\n        const radiusY = Math.abs(element.endY - element.startY) / 2;\n        drawRoughEllipse(ctx, centerX, centerY, radiusX, radiusY, {\n          strokeColor: element.color,\n          fillColor: element.fillStyle === 'transparent' ? 'transparent' : element.color,\n          strokeWidth: element.strokeWidth,\n          roughness: element.roughness || 1\n        });\n        break;\n      case 'text':\n        ctx.font = `${element.fontSize}px ${element.fontFamily}`;\n        ctx.fillStyle = element.color;\n        ctx.fillText(element.text, element.x, element.y);\n        break;\n      // Add more element types as needed\n    }\n    ctx.globalAlpha = 1;\n  };\n\n  // Drawing functions\n  const drawRoughRectangle = (ctx, x, y, width, height, options = {}) => {\n    const {\n      strokeColor = '#000',\n      fillColor = 'transparent',\n      strokeWidth = 2,\n      roughness = 1\n    } = options;\n    ctx.strokeStyle = strokeColor;\n    ctx.fillStyle = fillColor;\n    ctx.lineWidth = strokeWidth;\n    if (roughness > 0) {\n      // Add roughness effect\n      const offset = roughness * 2;\n      ctx.beginPath();\n      ctx.moveTo(x + Math.random() * offset, y + Math.random() * offset);\n      ctx.lineTo(x + width + Math.random() * offset, y + Math.random() * offset);\n      ctx.lineTo(x + width + Math.random() * offset, y + height + Math.random() * offset);\n      ctx.lineTo(x + Math.random() * offset, y + height + Math.random() * offset);\n      ctx.closePath();\n    } else {\n      ctx.rect(x, y, width, height);\n    }\n    if (fillColor !== 'transparent') ctx.fill();\n    ctx.stroke();\n  };\n  const drawRoughEllipse = (ctx, centerX, centerY, radiusX, radiusY, options = {}) => {\n    const {\n      strokeColor = '#000',\n      fillColor = 'transparent',\n      strokeWidth = 2,\n      roughness = 1\n    } = options;\n    ctx.strokeStyle = strokeColor;\n    ctx.fillStyle = fillColor;\n    ctx.lineWidth = strokeWidth;\n    ctx.beginPath();\n    if (roughness > 0) {\n      // Rough ellipse approximation\n      const steps = 32;\n      for (let i = 0; i <= steps; i++) {\n        const angle = i / steps * 2 * Math.PI;\n        const x = centerX + Math.cos(angle) * radiusX + (Math.random() - 0.5) * roughness * 2;\n        const y = centerY + Math.sin(angle) * radiusY + (Math.random() - 0.5) * roughness * 2;\n        if (i === 0) ctx.moveTo(x, y);else ctx.lineTo(x, y);\n      }\n    } else {\n      ctx.ellipse(centerX, centerY, radiusX, radiusY, 0, 0, 2 * Math.PI);\n    }\n    if (fillColor !== 'transparent') ctx.fill();\n    ctx.stroke();\n  };\n  const drawArrow = (ctx, startX, startY, endX, endY, options = {}) => {\n    const {\n      strokeColor = '#000',\n      strokeWidth = 2\n    } = options;\n    ctx.strokeStyle = strokeColor;\n    ctx.lineWidth = strokeWidth;\n\n    // Draw line\n    ctx.beginPath();\n    ctx.moveTo(startX, startY);\n    ctx.lineTo(endX, endY);\n    ctx.stroke();\n\n    // Draw arrowhead\n    const angle = Math.atan2(endY - startY, endX - startX);\n    const headLength = 15;\n    ctx.beginPath();\n    ctx.moveTo(endX, endY);\n    ctx.lineTo(endX - headLength * Math.cos(angle - Math.PI / 6), endY - headLength * Math.sin(angle - Math.PI / 6));\n    ctx.moveTo(endX, endY);\n    ctx.lineTo(endX - headLength * Math.cos(angle + Math.PI / 6), endY - headLength * Math.sin(angle + Math.PI / 6));\n    ctx.stroke();\n  };\n  const drawDiamond = (ctx, centerX, centerY, width, height, options = {}) => {\n    const {\n      strokeColor = '#000',\n      fillColor = 'transparent',\n      strokeWidth = 2\n    } = options;\n    ctx.strokeStyle = strokeColor;\n    ctx.fillStyle = fillColor;\n    ctx.lineWidth = strokeWidth;\n    ctx.beginPath();\n    ctx.moveTo(centerX, centerY - height / 2);\n    ctx.lineTo(centerX + width / 2, centerY);\n    ctx.lineTo(centerX, centerY + height / 2);\n    ctx.lineTo(centerX - width / 2, centerY);\n    ctx.closePath();\n    if (fillColor !== 'transparent') ctx.fill();\n    ctx.stroke();\n  };\n\n  // Event handlers\n  const handleMouseDown = e => {\n    const point = getCanvasPoint(e);\n    setIsDrawing(true);\n    setStartPoint(point);\n    if (tool === 'text') {\n      setTextPosition(point);\n      setIsTyping(true);\n      return;\n    }\n    if (tool === 'draw') {\n      const ctx = canvasRef.current.getContext('2d');\n      ctx.beginPath();\n      ctx.moveTo(point.x, point.y);\n      ctx.strokeStyle = color;\n      ctx.lineWidth = strokeWidth;\n      ctx.globalAlpha = opacity / 100;\n    }\n\n    // Emit start event\n    if (socket) {\n      socket.emit('draw-event', {\n        type: 'start',\n        tool,\n        x: point.x,\n        y: point.y,\n        color,\n        strokeWidth,\n        opacity\n      });\n    }\n  };\n  const handleMouseMove = e => {\n    if (!isDrawing || !startPoint) return;\n    const point = getCanvasPoint(e);\n    const ctx = canvasRef.current.getContext('2d');\n    if (tool === 'draw') {\n      ctx.lineTo(point.x, point.y);\n      ctx.stroke();\n      ctx.beginPath();\n      ctx.moveTo(point.x, point.y);\n      if (socket) {\n        socket.emit('draw-event', {\n          type: 'draw',\n          tool,\n          x: point.x,\n          y: point.y,\n          color,\n          strokeWidth,\n          opacity\n        });\n      }\n    }\n  };\n  const handleMouseUp = e => {\n    if (!isDrawing || !startPoint) return;\n    const point = getCanvasPoint(e);\n    const ctx = canvasRef.current.getContext('2d');\n    ctx.globalAlpha = opacity / 100;\n    const options = {\n      strokeColor: color,\n      fillColor: fillStyle === 'transparent' ? 'transparent' : color,\n      strokeWidth,\n      roughness\n    };\n    let elementData = {\n      id: generateId(),\n      type: tool,\n      startX: startPoint.x,\n      startY: startPoint.y,\n      endX: point.x,\n      endY: point.y,\n      color,\n      strokeWidth,\n      fillStyle,\n      opacity,\n      roughness\n    };\n    switch (tool) {\n      case 'rectangle':\n        const width = point.x - startPoint.x;\n        const height = point.y - startPoint.y;\n        drawRoughRectangle(ctx, startPoint.x, startPoint.y, width, height, options);\n        break;\n      case 'ellipse':\n        const centerX = (startPoint.x + point.x) / 2;\n        const centerY = (startPoint.y + point.y) / 2;\n        const radiusX = Math.abs(point.x - startPoint.x) / 2;\n        const radiusY = Math.abs(point.y - startPoint.y) / 2;\n        drawRoughEllipse(ctx, centerX, centerY, radiusX, radiusY, options);\n        break;\n      case 'diamond':\n        const diamondCenterX = (startPoint.x + point.x) / 2;\n        const diamondCenterY = (startPoint.y + point.y) / 2;\n        const diamondWidth = Math.abs(point.x - startPoint.x);\n        const diamondHeight = Math.abs(point.y - startPoint.y);\n        drawDiamond(ctx, diamondCenterX, diamondCenterY, diamondWidth, diamondHeight, options);\n        break;\n      case 'arrow':\n        drawArrow(ctx, startPoint.x, startPoint.y, point.x, point.y, options);\n        break;\n      case 'line':\n        ctx.beginPath();\n        ctx.strokeStyle = color;\n        ctx.lineWidth = strokeWidth;\n        ctx.moveTo(startPoint.x, startPoint.y);\n        ctx.lineTo(point.x, point.y);\n        ctx.stroke();\n        break;\n      case 'eraser':\n        // Eraser logic handled in mousemove\n        break;\n    }\n\n    // Add element to history\n    if (tool !== 'draw' && tool !== 'eraser') {\n      setElements(prev => [...prev, elementData]);\n    }\n\n    // Emit to socket\n    if (socket && tool !== 'draw') {\n      socket.emit('draw-event', {\n        type: 'shape',\n        ...elementData\n      });\n    }\n    setIsDrawing(false);\n    setStartPoint(null);\n    ctx.globalAlpha = 1;\n  };\n\n  // Text handling\n  const handleTextSubmit = () => {\n    if (!textInput.trim() || !textPosition) return;\n    const ctx = canvasRef.current.getContext('2d');\n    ctx.font = `${fontSize}px ${fontFamily}`;\n    ctx.fillStyle = color;\n    ctx.globalAlpha = opacity / 100;\n    ctx.fillText(textInput, textPosition.x, textPosition.y);\n    ctx.globalAlpha = 1;\n    const textElement = {\n      id: generateId(),\n      type: 'text',\n      x: textPosition.x,\n      y: textPosition.y,\n      text: textInput,\n      fontSize,\n      fontFamily,\n      color,\n      opacity\n    };\n    setElements(prev => [...prev, textElement]);\n    if (socket) {\n      socket.emit('draw-event', {\n        type: 'text',\n        ...textElement\n      });\n    }\n    setTextInput('');\n    setIsTyping(false);\n    setTextPosition(null);\n  };\n\n  // Clear canvas\n  const clearCanvas = () => {\n    const ctx = canvasRef.current.getContext('2d');\n    ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n    setElements([]);\n    if (socket) {\n      socket.emit('draw-event', {\n        type: 'clear'\n      });\n    }\n  };\n\n  // Zoom functions\n  const handleZoomIn = () => setZoom(prev => Math.min(prev + 10, 300));\n  const handleZoomOut = () => setZoom(prev => Math.max(prev - 10, 25));\n  const handleZoomReset = () => setZoom(100);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex-1 flex flex-col bg-white\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-gray-50 border-b border-gray-200 p-3\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: tools.map(t => /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setTool(t.name),\n            className: `p-2 rounded-lg text-sm flex flex-col items-center min-w-[50px] ${tool === t.name ? 'bg-blue-500 text-white' : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'}`,\n            title: t.label,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-lg\",\n              children: t.icon\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 499,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs mt-1\",\n              children: t.label\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 500,\n              columnNumber: 17\n            }, this)]\n          }, t.name, true, {\n            fileName: _jsxFileName,\n            lineNumber: 489,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleZoomOut,\n            className: \"px-2 py-1 bg-white border border-gray-300 rounded text-sm hover:bg-gray-50\",\n            children: \"\\u2212\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleZoomReset,\n            className: \"px-3 py-1 bg-white border border-gray-300 rounded text-sm hover:bg-gray-50\",\n            children: [zoom, \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 513,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleZoomIn,\n            className: \"px-2 py-1 bg-white border border-gray-300 rounded text-sm hover:bg-gray-50\",\n            children: \"+\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 485,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 484,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white border-b border-gray-200 p-3\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-6 flex-wrap\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-sm font-medium text-gray-700\",\n            children: \"Stroke:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 534,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex space-x-1\",\n            children: colors.map(c => /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setColor(c),\n              className: `w-6 h-6 rounded border-2 ${color === c ? 'border-blue-500' : 'border-gray-300'}`,\n              style: {\n                backgroundColor: c\n              }\n            }, c, false, {\n              fileName: _jsxFileName,\n              lineNumber: 537,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 535,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 533,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-sm font-medium text-gray-700\",\n            children: \"Width:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 551,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex space-x-1\",\n            children: strokeWidths.map(width => /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setStrokeWidth(width),\n              className: `px-2 py-1 rounded text-xs ${strokeWidth === width ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-700 border border-gray-300'}`,\n              children: [width, \"px\"]\n            }, width, true, {\n              fileName: _jsxFileName,\n              lineNumber: 554,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 552,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 550,\n          columnNumber: 11\n        }, this), ['rectangle', 'ellipse', 'diamond'].includes(tool) && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-sm font-medium text-gray-700\",\n            children: \"Fill:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: fillStyle,\n            onChange: e => setFillStyle(e.target.value),\n            className: \"px-2 py-1 border border-gray-300 rounded text-sm\",\n            children: fillStyles.map(style => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: style,\n              children: style\n            }, style, false, {\n              fileName: _jsxFileName,\n              lineNumber: 579,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 573,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 571,\n          columnNumber: 13\n        }, this), tool === 'text' && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"text-sm font-medium text-gray-700\",\n              children: \"Font:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 591,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: fontFamily,\n              onChange: e => setFontFamily(e.target.value),\n              className: \"px-2 py-1 border border-gray-300 rounded text-sm\",\n              children: fontFamilies.map(font => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: font,\n                children: font\n              }, font, false, {\n                fileName: _jsxFileName,\n                lineNumber: 598,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 592,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 590,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"text-sm font-medium text-gray-700\",\n              children: \"Size:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 605,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: fontSize,\n              onChange: e => setFontSize(parseInt(e.target.value)),\n              className: \"w-16 px-2 py-1 border border-gray-300 rounded text-sm\",\n              min: \"8\",\n              max: \"72\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 606,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 604,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-sm font-medium text-gray-700\",\n            children: \"Opacity:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 620,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"range\",\n            min: \"10\",\n            max: \"100\",\n            value: opacity,\n            onChange: e => setOpacity(parseInt(e.target.value)),\n            className: \"w-20\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 621,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm text-gray-600\",\n            children: [opacity, \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 629,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 619,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: clearCanvas,\n          className: \"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 text-sm\",\n          children: \"\\uD83D\\uDDD1\\uFE0F Clear\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 633,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 531,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 530,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 relative overflow-auto bg-gray-100\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-8 flex justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white shadow-lg\",\n          style: {\n            transform: `scale(${zoom / 100})`,\n            transformOrigin: 'top left'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n            ref: canvasRef,\n            onMouseDown: handleMouseDown,\n            onMouseMove: handleMouseMove,\n            onMouseUp: handleMouseUp,\n            onMouseLeave: handleMouseUp,\n            className: \"border border-gray-300 cursor-crosshair\",\n            style: {\n              cursor: tool === 'hand' ? 'grab' : tool === 'selection' ? 'default' : tool === 'text' ? 'text' : 'crosshair'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 649,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 645,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 644,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 643,\n      columnNumber: 7\n    }, this), isTyping && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white p-6 rounded-lg shadow-xl\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-medium mb-4\",\n          children: \"Add Text\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 670,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: textInput,\n          onChange: e => setTextInput(e.target.value),\n          className: \"w-80 h-32 p-3 border border-gray-300 rounded resize-none focus:outline-none focus:ring-2 focus:ring-blue-500\",\n          placeholder: \"Type your text here...\",\n          autoFocus: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 671,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end space-x-3 mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              setIsTyping(false);\n              setTextInput('');\n              setTextPosition(null);\n            },\n            className: \"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 679,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleTextSubmit,\n            className: \"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\",\n            children: \"Add Text\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 689,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 678,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 669,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 668,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 482,\n    columnNumber: 5\n  }, this);\n};\n_s(ExcalidrawCanvas, \"vRx8zxFfaJ1fNoZvZJFKlIHlXl8=\");\n_c = ExcalidrawCanvas;\nexport default ExcalidrawCanvas;\nvar _c;\n$RefreshReg$(_c, \"ExcalidrawCanvas\");","map":{"version":3,"names":["React","useRef","useEffect","useState","useCallback","LibraryPanel","ExportImportPanel","jsxDEV","_jsxDEV","Fragment","_Fragment","ExcalidrawCanvas","socket","workspaceData","_s","canvasRef","isDrawing","setIsDrawing","tool","setTool","color","setColor","strokeWidth","setStrokeWidth","fillStyle","setFillStyle","opacity","setOpacity","fontSize","setFontSize","fontFamily","setFontFamily","zoom","setZoom","startPoint","setStartPoint","currentShape","setCurrentShape","isTyping","setIsTyping","textInput","setTextInput","textPosition","setTextPosition","roughness","setRoughness","strokeStyle","setStrokeStyle","arrowType","setArrowType","elements","setElements","showLibrary","setShowLibrary","showExportImport","setShowExportImport","canvasOffset","setCanvasOffset","x","y","isDragging","setIsDragging","tools","name","icon","label","actionButtons","onClick","handleUndo","handleRedo","colors","strokeWidths","fillStyles","fontFamilies","canvas","current","width","height","ctx","getContext","lineCap","lineJoin","fillRect","console","log","getCanvasPoint","e","rect","getBoundingClientRect","scaleX","scaleY","clientX","left","clientY","top","generateId","Math","random","toString","substring","history","setHistory","historyIndex","setHistoryIndex","saveToHistory","newElements","newHistory","slice","push","length","redrawCanvas","elementsToRender","clearRect","forEach","element","renderElement","globalAlpha","type","drawRoughRectangle","startX","startY","endX","endY","strokeColor","fillColor","centerX","centerY","radiusX","abs","radiusY","drawRoughEllipse","font","fillText","text","options","lineWidth","offset","beginPath","moveTo","lineTo","closePath","fill","stroke","steps","i","angle","PI","cos","sin","ellipse","drawArrow","atan2","headLength","drawDiamond","handleMouseDown","point","emit","handleMouseMove","handleMouseUp","elementData","id","diamondCenterX","diamondCenterY","diamondWidth","diamondHeight","prev","handleTextSubmit","trim","textElement","clearCanvas","handleZoomIn","min","handleZoomOut","max","handleZoomReset","className","children","map","t","title","fileName","_jsxFileName","lineNumber","columnNumber","c","style","backgroundColor","includes","value","onChange","target","parseInt","transform","transformOrigin","ref","onMouseDown","onMouseMove","onMouseUp","onMouseLeave","cursor","placeholder","autoFocus","_c","$RefreshReg$"],"sources":["/home/piyush/Desktop/collabdraw/realtime-workspace/client/src/components/ExcalidrawCanvas.js"],"sourcesContent":["import React, { useRef, useEffect, useState, useCallback } from 'react';\nimport LibraryPanel from './LibraryPanel';\nimport ExportImportPanel from './ExportImportPanel';\n\nconst ExcalidrawCanvas = ({ socket, workspaceData }) => {\n  const canvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [tool, setTool] = useState('selection');\n  const [color, setColor] = useState('#000000');\n  const [strokeWidth, setStrokeWidth] = useState(2);\n  const [fillStyle, setFillStyle] = useState('transparent');\n  const [opacity, setOpacity] = useState(100);\n  const [fontSize, setFontSize] = useState(20);\n  const [fontFamily, setFontFamily] = useState('Arial');\n  const [zoom, setZoom] = useState(100);\n  const [startPoint, setStartPoint] = useState(null);\n  const [currentShape, setCurrentShape] = useState('rectangle');\n  const [isTyping, setIsTyping] = useState(false);\n  const [textInput, setTextInput] = useState('');\n  const [textPosition, setTextPosition] = useState(null);\n  const [roughness, setRoughness] = useState(1);\n  const [strokeStyle, setStrokeStyle] = useState('solid');\n  const [arrowType, setArrowType] = useState('none');\n  const [elements, setElements] = useState([]);\n  const [showLibrary, setShowLibrary] = useState(false);\n  const [showExportImport, setShowExportImport] = useState(false);\n  const [canvasOffset, setCanvasOffset] = useState({ x: 0, y: 0 });\n  const [isDragging, setIsDragging] = useState(false);\n\n  // Tools available\n  const tools = [\n    { name: 'selection', icon: '↖️', label: 'Select' },\n    { name: 'hand', icon: '✋', label: 'Hand' },\n    { name: 'rectangle', icon: '⬜', label: 'Rectangle' },\n    { name: 'diamond', icon: '💎', label: 'Diamond' },\n    { name: 'ellipse', icon: '⭕', label: 'Ellipse' },\n    { name: 'arrow', icon: '➡️', label: 'Arrow' },\n    { name: 'line', icon: '📏', label: 'Line' },\n    { name: 'draw', icon: '✏️', label: 'Draw' },\n    { name: 'text', icon: '📝', label: 'Text' },\n    { name: 'image', icon: '🖼️', label: 'Image' },\n    { name: 'eraser', icon: '🧽', label: 'Eraser' }\n  ];\n\n  // Action buttons\n  const actionButtons = [\n    { name: 'library', icon: '📚', label: 'Library', onClick: () => setShowLibrary(true) },\n    { name: 'export', icon: '📤', label: 'Export', onClick: () => setShowExportImport(true) },\n    { name: 'undo', icon: '↶', label: 'Undo', onClick: handleUndo },\n    { name: 'redo', icon: '↷', label: 'Redo', onClick: handleRedo }\n  ];\n\n  // Colors\n  const colors = [\n    '#000000', '#e03131', '#2f9e44', '#1971c2', '#f08c00',\n    '#e64980', '#7950f2', '#495057', '#ffffff', '#fab005'\n  ];\n\n  // Stroke widths\n  const strokeWidths = [1, 2, 4, 8];\n\n  // Fill styles\n  const fillStyles = ['transparent', 'solid', 'hachure', 'cross-hatch'];\n\n  // Font families\n  const fontFamilies = ['Arial', 'Helvetica', 'Georgia', 'Times', 'Courier'];\n\n  // Initialize canvas\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    canvas.width = 1200;\n    canvas.height = 800;\n    \n    const ctx = canvas.getContext('2d');\n    ctx.lineCap = 'round';\n    ctx.lineJoin = 'round';\n    \n    // White background\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    \n    console.log('Enhanced Canvas initialized');\n  }, []);\n\n  // Get canvas coordinates\n  const getCanvasPoint = useCallback((e) => {\n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n\n    return {\n      x: (e.clientX - rect.left) * scaleX,\n      y: (e.clientY - rect.top) * scaleY\n    };\n  }, []);\n\n  // Generate unique ID for elements\n  const generateId = () => Math.random().toString(36).substring(2, 15);\n\n  // Undo/Redo functionality\n  const [history, setHistory] = useState([]);\n  const [historyIndex, setHistoryIndex] = useState(-1);\n\n  const saveToHistory = (newElements) => {\n    const newHistory = history.slice(0, historyIndex + 1);\n    newHistory.push([...newElements]);\n    setHistory(newHistory);\n    setHistoryIndex(newHistory.length - 1);\n  };\n\n  const handleUndo = () => {\n    if (historyIndex > 0) {\n      setHistoryIndex(historyIndex - 1);\n      setElements(history[historyIndex - 1]);\n      redrawCanvas(history[historyIndex - 1]);\n    }\n  };\n\n  const handleRedo = () => {\n    if (historyIndex < history.length - 1) {\n      setHistoryIndex(historyIndex + 1);\n      setElements(history[historyIndex + 1]);\n      redrawCanvas(history[historyIndex + 1]);\n    }\n  };\n\n  // Redraw canvas with elements\n  const redrawCanvas = (elementsToRender) => {\n    const ctx = canvasRef.current.getContext('2d');\n    ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n\n    elementsToRender.forEach(element => {\n      renderElement(ctx, element);\n    });\n  };\n\n  // Render individual element\n  const renderElement = (ctx, element) => {\n    ctx.globalAlpha = (element.opacity || 100) / 100;\n    \n    switch (element.type) {\n      case 'rectangle':\n        drawRoughRectangle(ctx, element.startX, element.startY, \n          element.endX - element.startX, element.endY - element.startY, {\n            strokeColor: element.color,\n            fillColor: element.fillStyle === 'transparent' ? 'transparent' : element.color,\n            strokeWidth: element.strokeWidth,\n            roughness: element.roughness || 1\n          });\n        break;\n      case 'ellipse':\n        const centerX = (element.startX + element.endX) / 2;\n        const centerY = (element.startY + element.endY) / 2;\n        const radiusX = Math.abs(element.endX - element.startX) / 2;\n        const radiusY = Math.abs(element.endY - element.startY) / 2;\n        drawRoughEllipse(ctx, centerX, centerY, radiusX, radiusY, {\n          strokeColor: element.color,\n          fillColor: element.fillStyle === 'transparent' ? 'transparent' : element.color,\n          strokeWidth: element.strokeWidth,\n          roughness: element.roughness || 1\n        });\n        break;\n      case 'text':\n        ctx.font = `${element.fontSize}px ${element.fontFamily}`;\n        ctx.fillStyle = element.color;\n        ctx.fillText(element.text, element.x, element.y);\n        break;\n      // Add more element types as needed\n    }\n    \n    ctx.globalAlpha = 1;\n  };\n\n  // Drawing functions\n  const drawRoughRectangle = (ctx, x, y, width, height, options = {}) => {\n    const { strokeColor = '#000', fillColor = 'transparent', strokeWidth = 2, roughness = 1 } = options;\n    \n    ctx.strokeStyle = strokeColor;\n    ctx.fillStyle = fillColor;\n    ctx.lineWidth = strokeWidth;\n    \n    if (roughness > 0) {\n      // Add roughness effect\n      const offset = roughness * 2;\n      ctx.beginPath();\n      ctx.moveTo(x + Math.random() * offset, y + Math.random() * offset);\n      ctx.lineTo(x + width + Math.random() * offset, y + Math.random() * offset);\n      ctx.lineTo(x + width + Math.random() * offset, y + height + Math.random() * offset);\n      ctx.lineTo(x + Math.random() * offset, y + height + Math.random() * offset);\n      ctx.closePath();\n    } else {\n      ctx.rect(x, y, width, height);\n    }\n    \n    if (fillColor !== 'transparent') ctx.fill();\n    ctx.stroke();\n  };\n\n  const drawRoughEllipse = (ctx, centerX, centerY, radiusX, radiusY, options = {}) => {\n    const { strokeColor = '#000', fillColor = 'transparent', strokeWidth = 2, roughness = 1 } = options;\n    \n    ctx.strokeStyle = strokeColor;\n    ctx.fillStyle = fillColor;\n    ctx.lineWidth = strokeWidth;\n    \n    ctx.beginPath();\n    if (roughness > 0) {\n      // Rough ellipse approximation\n      const steps = 32;\n      for (let i = 0; i <= steps; i++) {\n        const angle = (i / steps) * 2 * Math.PI;\n        const x = centerX + Math.cos(angle) * radiusX + (Math.random() - 0.5) * roughness * 2;\n        const y = centerY + Math.sin(angle) * radiusY + (Math.random() - 0.5) * roughness * 2;\n        if (i === 0) ctx.moveTo(x, y);\n        else ctx.lineTo(x, y);\n      }\n    } else {\n      ctx.ellipse(centerX, centerY, radiusX, radiusY, 0, 0, 2 * Math.PI);\n    }\n    \n    if (fillColor !== 'transparent') ctx.fill();\n    ctx.stroke();\n  };\n\n  const drawArrow = (ctx, startX, startY, endX, endY, options = {}) => {\n    const { strokeColor = '#000', strokeWidth = 2 } = options;\n    \n    ctx.strokeStyle = strokeColor;\n    ctx.lineWidth = strokeWidth;\n    \n    // Draw line\n    ctx.beginPath();\n    ctx.moveTo(startX, startY);\n    ctx.lineTo(endX, endY);\n    ctx.stroke();\n    \n    // Draw arrowhead\n    const angle = Math.atan2(endY - startY, endX - startX);\n    const headLength = 15;\n    \n    ctx.beginPath();\n    ctx.moveTo(endX, endY);\n    ctx.lineTo(\n      endX - headLength * Math.cos(angle - Math.PI / 6),\n      endY - headLength * Math.sin(angle - Math.PI / 6)\n    );\n    ctx.moveTo(endX, endY);\n    ctx.lineTo(\n      endX - headLength * Math.cos(angle + Math.PI / 6),\n      endY - headLength * Math.sin(angle + Math.PI / 6)\n    );\n    ctx.stroke();\n  };\n\n  const drawDiamond = (ctx, centerX, centerY, width, height, options = {}) => {\n    const { strokeColor = '#000', fillColor = 'transparent', strokeWidth = 2 } = options;\n    \n    ctx.strokeStyle = strokeColor;\n    ctx.fillStyle = fillColor;\n    ctx.lineWidth = strokeWidth;\n    \n    ctx.beginPath();\n    ctx.moveTo(centerX, centerY - height / 2);\n    ctx.lineTo(centerX + width / 2, centerY);\n    ctx.lineTo(centerX, centerY + height / 2);\n    ctx.lineTo(centerX - width / 2, centerY);\n    ctx.closePath();\n    \n    if (fillColor !== 'transparent') ctx.fill();\n    ctx.stroke();\n  };\n\n  // Event handlers\n  const handleMouseDown = (e) => {\n    const point = getCanvasPoint(e);\n    setIsDrawing(true);\n    setStartPoint(point);\n\n    if (tool === 'text') {\n      setTextPosition(point);\n      setIsTyping(true);\n      return;\n    }\n\n    if (tool === 'draw') {\n      const ctx = canvasRef.current.getContext('2d');\n      ctx.beginPath();\n      ctx.moveTo(point.x, point.y);\n      ctx.strokeStyle = color;\n      ctx.lineWidth = strokeWidth;\n      ctx.globalAlpha = opacity / 100;\n    }\n\n    // Emit start event\n    if (socket) {\n      socket.emit('draw-event', {\n        type: 'start',\n        tool,\n        x: point.x,\n        y: point.y,\n        color,\n        strokeWidth,\n        opacity\n      });\n    }\n  };\n\n  const handleMouseMove = (e) => {\n    if (!isDrawing || !startPoint) return;\n\n    const point = getCanvasPoint(e);\n    const ctx = canvasRef.current.getContext('2d');\n\n    if (tool === 'draw') {\n      ctx.lineTo(point.x, point.y);\n      ctx.stroke();\n      ctx.beginPath();\n      ctx.moveTo(point.x, point.y);\n\n      if (socket) {\n        socket.emit('draw-event', {\n          type: 'draw',\n          tool,\n          x: point.x,\n          y: point.y,\n          color,\n          strokeWidth,\n          opacity\n        });\n      }\n    }\n  };\n\n  const handleMouseUp = (e) => {\n    if (!isDrawing || !startPoint) return;\n\n    const point = getCanvasPoint(e);\n    const ctx = canvasRef.current.getContext('2d');\n    ctx.globalAlpha = opacity / 100;\n\n    const options = {\n      strokeColor: color,\n      fillColor: fillStyle === 'transparent' ? 'transparent' : color,\n      strokeWidth,\n      roughness\n    };\n\n    let elementData = {\n      id: generateId(),\n      type: tool,\n      startX: startPoint.x,\n      startY: startPoint.y,\n      endX: point.x,\n      endY: point.y,\n      color,\n      strokeWidth,\n      fillStyle,\n      opacity,\n      roughness\n    };\n\n    switch (tool) {\n      case 'rectangle':\n        const width = point.x - startPoint.x;\n        const height = point.y - startPoint.y;\n        drawRoughRectangle(ctx, startPoint.x, startPoint.y, width, height, options);\n        break;\n\n      case 'ellipse':\n        const centerX = (startPoint.x + point.x) / 2;\n        const centerY = (startPoint.y + point.y) / 2;\n        const radiusX = Math.abs(point.x - startPoint.x) / 2;\n        const radiusY = Math.abs(point.y - startPoint.y) / 2;\n        drawRoughEllipse(ctx, centerX, centerY, radiusX, radiusY, options);\n        break;\n\n      case 'diamond':\n        const diamondCenterX = (startPoint.x + point.x) / 2;\n        const diamondCenterY = (startPoint.y + point.y) / 2;\n        const diamondWidth = Math.abs(point.x - startPoint.x);\n        const diamondHeight = Math.abs(point.y - startPoint.y);\n        drawDiamond(ctx, diamondCenterX, diamondCenterY, diamondWidth, diamondHeight, options);\n        break;\n\n      case 'arrow':\n        drawArrow(ctx, startPoint.x, startPoint.y, point.x, point.y, options);\n        break;\n\n      case 'line':\n        ctx.beginPath();\n        ctx.strokeStyle = color;\n        ctx.lineWidth = strokeWidth;\n        ctx.moveTo(startPoint.x, startPoint.y);\n        ctx.lineTo(point.x, point.y);\n        ctx.stroke();\n        break;\n\n      case 'eraser':\n        // Eraser logic handled in mousemove\n        break;\n    }\n\n    // Add element to history\n    if (tool !== 'draw' && tool !== 'eraser') {\n      setElements(prev => [...prev, elementData]);\n    }\n\n    // Emit to socket\n    if (socket && tool !== 'draw') {\n      socket.emit('draw-event', {\n        type: 'shape',\n        ...elementData\n      });\n    }\n\n    setIsDrawing(false);\n    setStartPoint(null);\n    ctx.globalAlpha = 1;\n  };\n\n  // Text handling\n  const handleTextSubmit = () => {\n    if (!textInput.trim() || !textPosition) return;\n\n    const ctx = canvasRef.current.getContext('2d');\n    ctx.font = `${fontSize}px ${fontFamily}`;\n    ctx.fillStyle = color;\n    ctx.globalAlpha = opacity / 100;\n    ctx.fillText(textInput, textPosition.x, textPosition.y);\n    ctx.globalAlpha = 1;\n\n    const textElement = {\n      id: generateId(),\n      type: 'text',\n      x: textPosition.x,\n      y: textPosition.y,\n      text: textInput,\n      fontSize,\n      fontFamily,\n      color,\n      opacity\n    };\n\n    setElements(prev => [...prev, textElement]);\n\n    if (socket) {\n      socket.emit('draw-event', {\n        type: 'text',\n        ...textElement\n      });\n    }\n\n    setTextInput('');\n    setIsTyping(false);\n    setTextPosition(null);\n  };\n\n  // Clear canvas\n  const clearCanvas = () => {\n    const ctx = canvasRef.current.getContext('2d');\n    ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n    setElements([]);\n\n    if (socket) {\n      socket.emit('draw-event', { type: 'clear' });\n    }\n  };\n\n  // Zoom functions\n  const handleZoomIn = () => setZoom(prev => Math.min(prev + 10, 300));\n  const handleZoomOut = () => setZoom(prev => Math.max(prev - 10, 25));\n  const handleZoomReset = () => setZoom(100);\n\n  return (\n    <div className=\"flex-1 flex flex-col bg-white\">\n      {/* Main Toolbar */}\n      <div className=\"bg-gray-50 border-b border-gray-200 p-3\">\n        <div className=\"flex items-center justify-between\">\n          {/* Left: Tools */}\n          <div className=\"flex items-center space-x-2\">\n            {tools.map((t) => (\n              <button\n                key={t.name}\n                onClick={() => setTool(t.name)}\n                className={`p-2 rounded-lg text-sm flex flex-col items-center min-w-[50px] ${\n                  tool === t.name\n                    ? 'bg-blue-500 text-white'\n                    : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'\n                }`}\n                title={t.label}\n              >\n                <span className=\"text-lg\">{t.icon}</span>\n                <span className=\"text-xs mt-1\">{t.label}</span>\n              </button>\n            ))}\n          </div>\n\n          {/* Right: Zoom Controls */}\n          <div className=\"flex items-center space-x-2\">\n            <button\n              onClick={handleZoomOut}\n              className=\"px-2 py-1 bg-white border border-gray-300 rounded text-sm hover:bg-gray-50\"\n            >\n              −\n            </button>\n            <button\n              onClick={handleZoomReset}\n              className=\"px-3 py-1 bg-white border border-gray-300 rounded text-sm hover:bg-gray-50\"\n            >\n              {zoom}%\n            </button>\n            <button\n              onClick={handleZoomIn}\n              className=\"px-2 py-1 bg-white border border-gray-300 rounded text-sm hover:bg-gray-50\"\n            >\n              +\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Properties Panel */}\n      <div className=\"bg-white border-b border-gray-200 p-3\">\n        <div className=\"flex items-center space-x-6 flex-wrap\">\n          {/* Stroke */}\n          <div className=\"flex items-center space-x-2\">\n            <label className=\"text-sm font-medium text-gray-700\">Stroke:</label>\n            <div className=\"flex space-x-1\">\n              {colors.map((c) => (\n                <button\n                  key={c}\n                  onClick={() => setColor(c)}\n                  className={`w-6 h-6 rounded border-2 ${\n                    color === c ? 'border-blue-500' : 'border-gray-300'\n                  }`}\n                  style={{ backgroundColor: c }}\n                />\n              ))}\n            </div>\n          </div>\n\n          {/* Stroke Width */}\n          <div className=\"flex items-center space-x-2\">\n            <label className=\"text-sm font-medium text-gray-700\">Width:</label>\n            <div className=\"flex space-x-1\">\n              {strokeWidths.map((width) => (\n                <button\n                  key={width}\n                  onClick={() => setStrokeWidth(width)}\n                  className={`px-2 py-1 rounded text-xs ${\n                    strokeWidth === width\n                      ? 'bg-blue-500 text-white'\n                      : 'bg-gray-100 text-gray-700 border border-gray-300'\n                  }`}\n                >\n                  {width}px\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Fill */}\n          {['rectangle', 'ellipse', 'diamond'].includes(tool) && (\n            <div className=\"flex items-center space-x-2\">\n              <label className=\"text-sm font-medium text-gray-700\">Fill:</label>\n              <select\n                value={fillStyle}\n                onChange={(e) => setFillStyle(e.target.value)}\n                className=\"px-2 py-1 border border-gray-300 rounded text-sm\"\n              >\n                {fillStyles.map((style) => (\n                  <option key={style} value={style}>\n                    {style}\n                  </option>\n                ))}\n              </select>\n            </div>\n          )}\n\n          {/* Font controls for text */}\n          {tool === 'text' && (\n            <>\n              <div className=\"flex items-center space-x-2\">\n                <label className=\"text-sm font-medium text-gray-700\">Font:</label>\n                <select\n                  value={fontFamily}\n                  onChange={(e) => setFontFamily(e.target.value)}\n                  className=\"px-2 py-1 border border-gray-300 rounded text-sm\"\n                >\n                  {fontFamilies.map((font) => (\n                    <option key={font} value={font}>\n                      {font}\n                    </option>\n                  ))}\n                </select>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <label className=\"text-sm font-medium text-gray-700\">Size:</label>\n                <input\n                  type=\"number\"\n                  value={fontSize}\n                  onChange={(e) => setFontSize(parseInt(e.target.value))}\n                  className=\"w-16 px-2 py-1 border border-gray-300 rounded text-sm\"\n                  min=\"8\"\n                  max=\"72\"\n                />\n              </div>\n            </>\n          )}\n\n          {/* Opacity */}\n          <div className=\"flex items-center space-x-2\">\n            <label className=\"text-sm font-medium text-gray-700\">Opacity:</label>\n            <input\n              type=\"range\"\n              min=\"10\"\n              max=\"100\"\n              value={opacity}\n              onChange={(e) => setOpacity(parseInt(e.target.value))}\n              className=\"w-20\"\n            />\n            <span className=\"text-sm text-gray-600\">{opacity}%</span>\n          </div>\n\n          {/* Clear button */}\n          <button\n            onClick={clearCanvas}\n            className=\"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 text-sm\"\n          >\n            🗑️ Clear\n          </button>\n        </div>\n      </div>\n\n      {/* Canvas Area */}\n      <div className=\"flex-1 relative overflow-auto bg-gray-100\">\n        <div className=\"p-8 flex justify-center\">\n          <div \n            className=\"bg-white shadow-lg\"\n            style={{ transform: `scale(${zoom / 100})`, transformOrigin: 'top left' }}\n          >\n            <canvas\n              ref={canvasRef}\n              onMouseDown={handleMouseDown}\n              onMouseMove={handleMouseMove}\n              onMouseUp={handleMouseUp}\n              onMouseLeave={handleMouseUp}\n              className=\"border border-gray-300 cursor-crosshair\"\n              style={{\n                cursor: tool === 'hand' ? 'grab' : \n                       tool === 'selection' ? 'default' :\n                       tool === 'text' ? 'text' : 'crosshair'\n              }}\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* Text Input Modal */}\n      {isTyping && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white p-6 rounded-lg shadow-xl\">\n            <h3 className=\"text-lg font-medium mb-4\">Add Text</h3>\n            <textarea\n              value={textInput}\n              onChange={(e) => setTextInput(e.target.value)}\n              className=\"w-80 h-32 p-3 border border-gray-300 rounded resize-none focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Type your text here...\"\n              autoFocus\n            />\n            <div className=\"flex justify-end space-x-3 mt-4\">\n              <button\n                onClick={() => {\n                  setIsTyping(false);\n                  setTextInput('');\n                  setTextPosition(null);\n                }}\n                className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleTextSubmit}\n                className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\n              >\n                Add Text\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ExcalidrawCanvas;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}